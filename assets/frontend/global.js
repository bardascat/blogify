var url = "http://dev.helpie.ro/";var map = null;var globalZoom = 0;function displayMap(lat, lon) {    initialize(lat, lon);}function displayPartnerMap(lat, lon) {    // create the map    var myLatlng = new google.maps.LatLng(lat, lon);    var myOptions = {        zoom: (globalZoom ? globalZoom : 15),        center: new google.maps.LatLng(lat, lon),        mapTypeId: google.maps.MapTypeId.ROADMAP    }    map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);    var marker = new google.maps.Marker({        position: myLatlng,        map: map,        title: ""    });    google.maps.event.addListener(map, 'click', function(event) {        marker.setMap(null);        var lat = event.latLng.lat();        var lng = event.latLng.lng();        $('.lat').val(lat);        $('.lng').val(lng);        marker = new google.maps.Marker({position: event.latLng, map: map});    });    var getCen = map.getCenter();    google.maps.event.addListener(map, 'resize', function(event) {        console.log('da');        console.log(getCen);        map.setCenter(new google.maps.LatLng(lat, lon));    });    var myLatlng = new google.maps.LatLng(lat, lon);}function initialize(lat, lon) {    // create the map    var myLatlng = new google.maps.LatLng(lat, lon);    var myOptions = {        zoom: (globalZoom ? globalZoom : 15),        center: new google.maps.LatLng(lat, lon),        mapTypeId: google.maps.MapTypeId.ROADMAP    }    map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);    var marker = new google.maps.Marker({        position: myLatlng,        map: map,        title: ""    });    var myLatlng = new google.maps.LatLng(lat, lon);}function change_city() {    $('#oras_form').submit();}function login() {    $('#login_form').fadeToggle(100);}function contul_meu() {    $('.contul_meu_container').fadeToggle(100);}$(document).ready(function() {    $(".header_categories").mouseleave(function() {       $('.subcats').fadeOut(0);    });    $('.subcats').mouseleave(function() {        $('.subcats').fadeOut(0);    });    $('.subcats_user_menu').mouseleave(function() {        $('.subcats_user_menu').fadeOut(0);    });    $(".shopping_cart").mouseleave(function() {       $('#cart_header').fadeOut(100);    });    $(".shopping_cart").mouseenter(function() {        $('#cart_header').fadeIn(100);    });    $(document).click(function() {        $('.abonare_form').slideUp(0, function() {            $('.abonare_icon').slideDown(300);        })    });    $(".abonare_form,.abonare_icon").click(function(event) {        event.stopPropagation();    });$('#filterMenu').mouseleave(function() {       $('#filterMenu').fadeOut(100);});})function toggleLoginHeader() {    $('#header_login').fadeToggle(100);}function toggleMyAccount() {    $('.my_account .subcats_user_menu').fadeToggle(100);}function closeSubcats(){     $('.subcats').fadeOut(0);}function show_subcats(cat) {    var top = ($('#parent_' + cat).offset().top);    var left = ($('#parent_' + cat).offset().left);    $('.categorii ul').fadeOut(0);    //$('#' + cat).offset({ top:top, left:left})    $('.header_categories .subcats').fadeOut(0);    $('#' + cat).fadeIn(0, function() {    });    $('#' + cat).mouseleave(function(e) {       $(this).fadeOut(0);    });}function close_subcats() {    $('.categorii ul').fadeOut(50);}function main_img_mouseover(elem) {    var id = $(elem).attr('id');    $('#anim_' + id).css({left: $(elem).offset().left, top: $(elem).offset().top})    $('#anim_' + id).fadeIn(150);}function main_img_mouseleave(elem) {    $('.lupa_hover').fadeOut();}function mouse_over_img(element) {    element.src = url + "assets/images_fdd/hover_lupa_1.png";}function mouse_out_img(element) {    element.src = url + "assets/images_fdd/lupa_1.png";}function mouse_over_img_cumpara(element) {    element.src = url + "assets/images_fdd/hover_cumpara_1.png";}function mouse_out_img_cumpara(element) {    element.src = url + "assets/images_fdd/carucior_1.png";}function triggerAddOfferPopup() {    var firstAttribute = "";    var secondAttribute = "";    var id_item = $('input[name="id_item"]').val();    var quantity = encodeURI($('input[name="quantity"]').val());    //generam url-ul     var getUrl = url + "admin/orders/addOrderOfferPopup/" + id_item + "/" + quantity;    $('#triggerAddItemPopup').attr("href", getUrl);    $('#triggerAddItemPopup').trigger("click");}function increment_offer_view(id_item) {    $.ajax({        type: "POST",        url: url + "oferte/increment_offer_view",        data: 'id_item=' + id_item,        dataType: 'json',        success: function(result) {        }})}function showAvailableDay(id_option, input) {    console.log("s-a schimbat");    var selectedDate = $(input).val();    if(!selectedDate)        return false;        $.ajax({        type: "POST",        url: url + "partener/getOptionAvailablePosition",        data: 'id_option=' + id_option + "&scheduled=" + selectedDate,        dataType: 'json',        success: function(result) {            switch (result.position.type) {                case "success":                    {                        alert('In data de ' + selectedDate + ' oferta dumneavoastra va fi pe pozitia ' + result.position.nr);                    }                    break;                default:                    {                        alert(result.position.info);                    }                    break;            }        }})}function updateQuantity(id_cartItem, type) {    console.log(type);    switch (type) {        case "plus":            {                $('#updateForm').append('<input type="hidden" name="plus"/>');            }            break;        case "minus":            {                $('#updateForm').append('<input type="hidden" name="minus"/>');            }            break;    }    $('#updateForm input[name="cartItem"]').val(id_cartItem);    $('#updateForm').submit();}function login_header() {    $('#header_login form').submit();}function load_partner_editor(width, height) {    if (!width)        width = "90%";    if (!height)        height = "200";    var op = {        filebrowserUploadUrl: url + 'Controllers/uploader/upload.php?type=Files',        width: width,        height: height,        toolbar:                [                    '/',                    {                        name: 'styles',                        items: ['Source', 'FontSize', 'Font', 'TextColor', 'BGColor', 'Bold', 'Italic', 'Strike']                    },                    {                        name: 'insert',                        items: ['Image', 'Table', 'PageBreak', 'Link', 'Unlink']                    },                    {                        name: 'basicstyles',                        items: ['Bold', 'Italic', 'Strike', '-', 'RemoveFormat', '-', 'JustifyLeft', 'JustifyCenter', 'JustifyRight', 'JustifyBlock']                    },                ]    }    CKEDITOR.replace('description', op);}function load_offer_editor(width, height) {    if (!width)        width = "90%";    if (!height)        height = "150";    var op = {        filebrowserUploadUrl: url + 'Controllers/uploader/upload.php?type=Files',        width: width,        height: height,        toolbar:                [                    '/',                    {                        name: 'styles',                        items: ['Source', 'FontSize', 'Font', 'TextColor', 'BGColor', 'Bold', 'Italic', 'Strike']                    },                    {                        name: 'insert',                        items: ['Image', 'Table', 'Link', 'Unlink']                    },                    {                        name: 'basicstyles',                        items: ['Bold', 'Italic', 'Strike', 'JustifyLeft', 'JustifyCenter', 'JustifyRight', 'JustifyBlock']                    },                ]    }        CKEDITOR.replace('benefits', op);}function selectSubcategory(categoryDOM, selectedSubcategory) {    id_category = $(categoryDOM).val();    if (id_category == 0) {        alert('Va rugam alegeti o categorie');        return false;    }    else {        $.ajax({            type: "GET",            url: url + "categorii/getSubcategory",            data: "id_category=" + id_category + '&selectedSubcategory=' + selectedSubcategory,            dataType: 'json',            success: function(result) {                if (result.type == "success") {                    $('select[name="subcategory"]').empty();                    $('select[name="subcategory"]').append(result.data);                }                else {                    alert("Eroare: " + result.msg);                }            }})    }}function new_image() {    newImages = 0;    var existingImages = $('#tabs-4 .image').length;    $("#tabs-4 input[name='image[]']").each(function(index) {        newImages++;    });    var total = existingImages + newImages;    if (total == 5) {        alert("Puteti uploada maxim 5 poze");        return false;    }    else {        var new_image_html = "<div class='image_group'><input onchange='new_image(this)' type='file' name='image[]'/></div>";        $('.add_images').append(new_image_html);    }}function set_primary_image(id_image) {    $.ajax({        type: "POST",        url: url + "partener/set_primary_image",        data: "id_image=" + id_image,        dataType: 'json',        success: function(result) {            $('#image_' + id_image).css('border', '1px solid blue');            $("#dialog-form").dialog("close");        }})}function delete_image(id_image) {    $.ajax({        type: "POST",        url: url + "partener/delete_image",        data: "id_image=" + id_image,        dataType: 'json',        success: function(result) {            if (result.type == "success") {                $('#image_' + id_image).fadeOut(400, function() {                    $('#image_' + id_image).remove();                })                $("#dialog-form").dialog("close");            }            else {                alert("Eroare: " + result.msg);            }        }})}function addOfferFormCategories() {    $('#select_categories input[type=checkbox]').each(function() {        if (this.checked) {            var input = $("<input>").attr("type", "hidden").attr("name", "categories[]").val($(this).val());            console.log(input);            $('#offerForm .categoriesInput').append(input);        }    });}function send_mail() {    var urlPath = $('.contact form').attr('action');    var name = $('#name').val();    var email = $('#email').val();      var mesaj = $('#mesaj').val();    var errorMsg = "";    if (name.length < 3) {        errorMsg += "Introduceti numele dvs.<br><br>";    }    if (mesaj.length < 10)        errorMsg += "Introduceti mesajul. Minim 10 caratere<br><br>";    if (!checkEmail(email)) {        errorMsg += "Adresa de email este incorecta<br><br>";    }    if (errorMsg != "") {        alert(errorMsg);        return false;    }    else {        $.ajax({            type: "POST",            url: urlPath,            data: "name=" + name + "&email=" + email + "&mesaj=" + mesaj        }).done(function(msg) {           $('#name').val("");            $('#email').val("");                      $('#mesaj').val("");            alert("<p>"+msg+"</p>");        });    }    return false;}function alert(msg) {    var n = noty({        layout: 'topCenter',        type: 'success',        text: msg,        dismissQueue: true, // If you want to use queue feature set this true        timeout: 3000,    });}function checkEmail(email) {    var filter = /^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;    if (!filter.test(email)) {        return false;    } else        return true;}function showSelectedCategories() {    $('#selectedCategories').empty();    var categories = '';    $('#select_categories input[type=checkbox]').each(function() {        if (this.checked) {            categories += ($(this).attr('category_name')) + ', ';        }    });    if (categories)        $('#selectedCategories').append('(' + categories.slice(0, -2) + ')');}function submitOfferForm() {    addOfferFormCategories();    $('#offerForm').submit();}function removeVariant(id_variant, action) {    if (action) {        $.ajax({            type: "POST",            url: url + "partener/toggleVariant",            data: "id_variant=" + id_variant + '&action=' + action,            dataType: 'json',            success: function(result) {                if (action == "active") {                    var msg1 = "Varianta Activa";                    var msg2 = "Dezactiveaza Varianta";                    var new_action = "inactive";                }                else {                    var msg1 = "Varianta Inactiva";                    var msg2 = "Activeaza Varianta";                    var new_action = "active";                }                /*                 $('#variant_' + id_variant + ' .variantHeader').html(msg1);                 $('#variant_' + id_variant + ' .removeVariant').html(msg2);                 $('#variant_' + id_variant + ' .removeVariant').attr('onclick', "removeVariant(" + id_variant + ",'" + new_action + "')");                 */                $('#variant_' + id_variant).fadeOut(300, function() {                    $('#variant_' + id_variant).remove();                });            }        });    } else        $('#variant_' + id_variant).fadeOut(300, function() {            $('#variant_' + id_variant).remove();        });}function addItemVariant() {    var rand = 1 + Math.floor(Math.random() * 99999);    var pret_intreg = '<tr><td width="128"><label>Pret Intreg</label></td><td class=""><input type="hidden" value="" name="id_attribute_value[]"><input name="id_attribute[]" value="1" type="hidden"><input  onkeyup="numericRestrict(this)"  name="attribute_value[]" value="" type="text"> lei</td></tr>';    var pret_redus = '<tr><td width="128"><label>Pret Redus</label></td><td class=""><input type="hidden" value="" name="id_attribute_value[]"><input name="id_attribute[]" value="2" type="hidden"><input onkeyup="numericRestrict(this)"  name="attribute_value[]" value="" type="text"> lei</td> </tr>';    var descriere = '<tr><td width="128"><label>Descriere</label></td><td class=""><input type="hidden" value="" name="id_attribute_value[]"><input name="id_attribute[]" value="3" type="hidden"><textarea  style="width: 264px;" name="attribute_value[]"></textarea></td></tr>';    var status = '<tr><td width="128"><label>Activa?</label></td><td class=""><input type="hidden" value="" name="id_attribute_value[]"><input name="id_attribute[]" value="6" type="hidden"><select name="attribute_value[]"><option value="1">Da</option><option value="0">Nu</option></select></td></tr>';    var attributes = pret_intreg + pret_redus + descriere + status;    var html = '<li id="variant_' + rand + '"><div class = "removeVariant" onclick = "removeVariant(' + rand + ',0)"> Sterge Varianta </div><table width = "100%" border = "0" class = "attributesTable"><input type="hidden" name="id_variant[]" value=""/></td></tr>' + attributes + '</table></li>';    $('.variants_table .variant_list ol').prepend(html);}function deleteCartItem(id) {    $('#deleteForm input[name="cartItem"]').val(id);    $('#deleteForm').submit();}function add_to_cart(id_item, type) {    switch (type) {        case "mb":            {                $.ajax({                    type: "POST",                    url: url + "oferte/loadItemVariant",                    data: "id_item=" + id_item,                    dataType: 'json',                    success: function(result) {                        switch (result.type) {                            case "success":                                {                                    /*                                     *  $.fancybox.open({                                     padding: 0,                                     href: url + 'oferte/loadItemVariant?id_item=' + id_item,                                     type: 'iframe',                                     width:685,                                     closeClick: false,                                     openEffect: 'none',                                     closeEffect: 'none',                                     afterShow: function() {                                                                          }                                     });                                     */                                    $.fancybox.open({                                        content: result.html,                                        width: 700,                                        autoSize: true,                                        closeClick: false,                                        openEffect: 'none',                                        closeEffect: 'none',                                        afterShow: function() {                                            $.fancybox.update();                                        }                                    });                                }                                break;                            default:                                {                                    alert('<br/><br/>Siteul a intampinat o eroare. Va rugam incercati mai tarziu. Multumim');                                    return false;                                }                                break;                        }                    }                });            }            break;        default:            {                $('#cart_form').submit();            }            break;    }    //type='mb' =>oferta multiple buy, afisam un popup de unde alege omul oferta preferata    //else submit}function showOfferDetails(id_offer) {    $('.offer_' + id_offer + ' .image_over').fadeIn(0);}function hideOfferDetails(id_offer) {    $('.offer_' + id_offer + ' .image_over').fadeOut(0);}function showAbonareForm() {    $('.abonare_icon').slideUp(0, function() {        $('.abonare_form').slideDown(300);    })}function abonareNewsletter(form, input) {    var email = $('#' + input).val();    $.ajax({        type: "POST",        url: url + "newsletter/subscribe",        data: 'email=' + email,        dataType: 'json',        success: function(result) {            if (result.type == "success") {                var n = noty({                    layout: 'topCenter',                    type: 'success',                    text: 'Multumim pentru abonare.',                    dismissQueue: true, // If you want to use queue feature set this true                    timeout: 3000,                });                $('.abonare_form').slideUp(0, function() {                    $('.abonare_icon').slideDown(300);                })            }            else if (result.type == "already") {                var n = noty({                    layout: 'topCenter',                    type: 'success',                    text: 'Adresa de email este deja abonata la newsletter.',                    dismissQueue: true, // If you want to use queue feature set this true                    timeout: 3000,                });                $('.abonare_form').slideUp(0, function() {                    $('.abonare_icon').slideDown(300);                })            }            else {                var n = noty({                    layout: 'topCenter',                    type: 'error',                    text: 'Adresa de email este incorecta.',                    dismissQueue: true, // If you want to use queue feature set this true                    timeout: 3000,                });            }        }})    return false;}function toggleFilter(){    $('#filterMenu').fadeToggle(100);}